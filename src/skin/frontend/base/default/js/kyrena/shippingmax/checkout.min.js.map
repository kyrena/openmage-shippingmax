{"version":3,"sources":["checkout.js"],"sourcesContent":["/**\n * Created V/12/04/2019\n * Updated M/22/03/2022\n *\n * Copyright 2019-2023 | Fabrice Creuzot <fabrice~cellublue~com>\n * Copyright 2019-2022 | Jérôme Siau <jerome~cellublue~com>\n * https://github.com/kyrena/openmage-shippingmax\n *\n * This program is free software, you can redistribute it or modify\n * it under the terms of the GNU General Public License (GPL) as published\n * by the free software foundation, either version 2 of the license, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but without any warranty, without even the implied warranty of\n * merchantability or fitness for a particular purpose. See the\n * GNU General Public License (GPL) for more details.\n */\n\nif (window.NodeList && !NodeList.prototype.forEach) {\n\tNodeList.prototype.forEach = function (callback, that, i) {\n\t\tthat = that || window;\n\t\tfor (i = 0; i < this.length; i++)\n\t\t\tcallback.call(that, this[i], i, this);\n\t};\n}\n\nvar shippingmax = new (function () {\n\n\t\"use strict\";\n\tthis.scroll = 0;\n\n\tthis.init = function () {\n\n\t\tif (document.getElementById('shipping_method-progress-opcheckout')) {\n\t\t\tvar observer = new MutationObserver(function () { checkout.reloadStep('shipping'); });\n\t\t\tobserver.observe(document.getElementById('shipping_method-progress-opcheckout'), {\n\t\t\t\tattributes: false,\n\t\t\t\tchildList: true,\n\t\t\t\tcharacterData: false\n\t\t\t});\n\t\t}\n\t};\n\n\tthis.open = function (src) {\n\n\t\tif (document.getElementById('shippingmaxDialog'))\n\t\t\treturn;\n\n\t\tthis.scroll = window.scrollY;\n\t\tvar data = document.createElement('div');\n\t\tdata.innerHTML =\n\t\t\t'<div id=\"shippingmaxDialog\" onclick=\"shippingmax.close(event);\">' +\n\t\t\t\t'<div id=\"shippingmaxBox\">' +\n\t\t\t\t\t'<iframe type=\"text/html\" src=\"' + src + '\" class=\"loader\" onload=\"this.removeAttribute(\\'class\\');\"></iframe>' +\n\t\t\t\t\t'<div class=\"loader\"></div>' +\n\t\t\t\t'</div>' +\n\t\t\t'</div>';\n\n\t\tdocument.querySelector('body').appendChild(data.firstChild);\n\t\tdocument.querySelector('body').classList.add('no-scroll');\n\t\tdocument.addEventListener('keydown', shippingmax.keyClose);\n\t};\n\n\tthis.keyClose = function (ev) {\n\n\t\tif (ev.keyCode === 27) {\n\t\t\tconsole.log('shippingmax.map - esc/keyClose');\n\t\t\tev.preventDefault();\n\t\t\tshippingmax.close(true);\n\t\t}\n\t};\n\n\tthis.close = function (ev) {\n\n\t\tdocument.querySelectorAll('.shipment-methods .dummy, .sp-methods .dummy').forEach(function (elem) { elem.checked = false; });\n\n\t\tif (ev !== true) {\n\t\t\tif (ev.target.getAttribute('id') === 'shippingmaxDialog')\n\t\t\t\tev = true;\n\t\t}\n\n\t\tif (ev === true) {\n\t\t\tdocument.getElementById('shippingmaxDialog').remove();\n\t\t\tdocument.querySelector('body').classList.remove('no-scroll');\n\t\t\tdocument.removeEventListener('keydown', shippingmax.keyClose);\n\t\t\twindow.scrollTo(0, shippingmax.scroll);\n\t\t}\n\t};\n\n\tthis.click = function (id) {\n\t\tdocument.getElementById(id).parentNode.querySelector('label').click();\n\t};\n\n\tthis.show = function (data) {\n\n\t\tthis.close(true);\n\n\t\tvar elem = document.getElementById(data.code);\n\t\tif (elem) {\n\t\t\telem.innerHTML = data.html.slice(data.html.indexOf('>') + 1, -6); // supprime la <div id></div>\n\t\t\telem.parentNode.querySelector('input').checked = true;\n\t\t\tdocument.dispatchEvent(new CustomEvent('shippingmax_update'));\n\t\t\telem.parentNode.querySelector('label').click();\n\t\t}\n\t};\n\n})();\n\nif (typeof self.addEventListener == 'function')\n\tself.addEventListener('load', shippingmax.init);"],"names":["window","NodeList","prototype","forEach","callback","that","i","this","length","call","shippingmax","scroll","init","document","getElementById","MutationObserver","checkout","reloadStep","observe","attributes","childList","characterData","open","src","data","scrollY","createElement","innerHTML","querySelector","appendChild","firstChild","classList","add","addEventListener","keyClose","ev","keyCode","console","log","preventDefault","close","querySelectorAll","elem","checked","target","getAttribute","remove","removeEventListener","scrollTo","click","id","parentNode","show","code","html","slice","indexOf","dispatchEvent","CustomEvent","self"],"mappings":";;;;;;GAmBIA;OAAOC,UAAY,CAACA,SAASC,UAAUC,UAC1CF,SAASC,UAAUC,QAAU,SAAUC,EAAUC,EAAMC,GAEtD,IADAD,EAAOA,GAAQL,OACVM,EAAI,EAAGA,EAAIC,KAAKC,OAAQF,CAAC,GAC7BF,EAASK,KAAKJ,EAAME,KAAKD,GAAIA,EAAGC,IAAI,CACtC,GAGD,IAAIG,YAAc,IAAI,WAErB,aACAH,KAAKI,OAAS,EAEdJ,KAAKK,KAAO,WAEPC,SAASC,eAAe,qCAAqC,GACjD,IAAIC,iBAAiB,WAAcC,SAASC,WAAW,UAAU,CAAG,CAAC,EAC3EC,QAAQL,SAASC,eAAe,qCAAqC,EAAG,CAChFK,WAAY,CAAA,EACZC,UAAW,CAAA,EACXC,cAAe,CAAA,CAChB,CAAC,CAEH,EAEAd,KAAKe,KAAO,SAAUC,GAErB,IAIIC,EAJAX,SAASC,eAAe,mBAAmB,IAG/CP,KAAKI,OAASX,OAAOyB,SACjBD,EAAOX,SAASa,cAAc,KAAK,GAClCC,UACJ,0HAEqCJ,EAGrC,6GAEDV,SAASe,cAAc,MAAM,EAAEC,YAAYL,EAAKM,UAAU,EAC1DjB,SAASe,cAAc,MAAM,EAAEG,UAAUC,IAAI,WAAW,EACxDnB,SAASoB,iBAAiB,UAAWvB,YAAYwB,QAAQ,EAC1D,EAEA3B,KAAK2B,SAAW,SAAUC,GAEN,KAAfA,EAAGC,UACNC,QAAQC,IAAI,gCAAgC,EAC5CH,EAAGI,eAAe,EAClB7B,YAAY8B,MAAM,CAAA,CAAI,EAExB,EAEAjC,KAAKiC,MAAQ,SAAUL,GAEtBtB,SAAS4B,iBAAiB,8CAA8C,EAAEtC,QAAQ,SAAUuC,GAAQA,EAAKC,QAAU,CAAA,CAAO,CAAC,EAOhH,CAAA,KAHTR,EAFS,CAAA,IAAPA,GACkC,sBAAjCA,EAAGS,OAAOC,aAAa,IAAI,EACzB,CAAA,EAGHV,KACHtB,SAASC,eAAe,mBAAmB,EAAEgC,OAAO,EACpDjC,SAASe,cAAc,MAAM,EAAEG,UAAUe,OAAO,WAAW,EAC3DjC,SAASkC,oBAAoB,UAAWrC,YAAYwB,QAAQ,EAC5DlC,OAAOgD,SAAS,EAAGtC,YAAYC,MAAM,EAEvC,EAEAJ,KAAK0C,MAAQ,SAAUC,GACtBrC,SAASC,eAAeoC,CAAE,EAAEC,WAAWvB,cAAc,OAAO,EAAEqB,MAAM,CACrE,EAEA1C,KAAK6C,KAAO,SAAU5B,GAErBjB,KAAKiC,MAAM,CAAA,CAAI,EAEf,IAAIE,EAAO7B,SAASC,eAAeU,EAAK6B,IAAI,EACxCX,IACHA,EAAKf,UAAYH,EAAK8B,KAAKC,MAAM/B,EAAK8B,KAAKE,QAAQ,GAAG,EAAI,EAAG,CAAC,CAAC,EAC/Dd,EAAKS,WAAWvB,cAAc,OAAO,EAAEe,QAAU,CAAA,EACjD9B,SAAS4C,cAAc,IAAIC,YAAY,oBAAoB,CAAC,EAC5DhB,EAAKS,WAAWvB,cAAc,OAAO,EAAEqB,MAAM,EAE/C,CAEA,EAEmC,YAAhC,OAAOU,KAAK1B,kBACf0B,KAAK1B,iBAAiB,OAAQvB,YAAYE,IAAI"}